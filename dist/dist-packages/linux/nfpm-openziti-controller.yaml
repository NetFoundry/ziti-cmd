# nfpm configuration file
#
# check https://nfpm.goreleaser.com/configuration for detailed usage
#
name: openziti-controller
arch: ${GOARCH}
platform: linux
version: ${ZITI_VERSION}
maintainer: ${ZITI_MAINTAINER}
description: >
  Provides a system service for running an OpenZiti Controller
vendor: ${ZITI_VENDOR}
homepage: ${ZITI_HOMEPAGE}
license: Apache-2.0

# Umask to be used on files without explicit mode set. (overridable)
umask: 0o002

# Package version within this release version.
release: 1

# Section.
section: default

# Priority.
priority: optional

depends:
  - openziti  # ziti CLI

# Contents to add to the package.
contents:
  - dst: /lib/systemd/system/
    src: ./dist/dist-packages/linux/openziti-controller/ziti-controller.service

  - dst: /opt/openziti/etc/controller
    type: dir
    file_info:
      mode: 0755

  - dst: /opt/openziti/etc/controller/
    src: ./dist/dist-packages/linux/openziti-controller/env
    type: config|noreplace

  - dst: /opt/openziti/etc/controller/
    src: ./dist/dist-packages/linux/openziti-controller/entrypoint.bash

